<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø³ØªØ± Ø­Ù…Ø¯ÙŠ | Ø®Ø¨ÙŠØ± Ø§Ù„Ø£Ø­ÙŠØ§Ø¡</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

    <style>
        :root {
            --primary: #00e5ff; 
            --accent: #ff1744;
            --bg: #05080f; 
            --card-bg: rgba(255, 255, 255, 0.03);
            --text: #e2e8f0;
            --nav-bg: rgba(10, 15, 28, 0.85);
            --glow: rgba(0, 229, 255, 0.4);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }

        body { background-color: var(--bg); color: var(--text); overflow-x: hidden; }

        #particles-js { position: fixed; width: 100%; height: 100%; z-index: -1; }

        /* ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø·ÙˆØ§Ø±Ø¦ */
        #emergency-bar {
            position: fixed; top: 0; width: 100%; background: var(--accent);
            color: white; padding: 10px; text-align: center; z-index: 9999;
            font-weight: bold; display: none; overflow: hidden;
        }

        nav {
            position: fixed; top: 0; width: 100%; padding: 15px 5%;
            background: var(--nav-bg); backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center;
            z-index: 1000; border-bottom: 1px solid rgba(0, 229, 255, 0.1);
        }

        .logo { font-size: 1.5rem; font-weight: 900; color: var(--primary); text-shadow: 0 0 10px var(--glow); }

        .user-stats { display: flex; gap: 15px; align-items: center; }
        .stat-item { background: var(--card-bg); padding: 5px 15px; border-radius: 20px; border: 1px solid var(--primary); font-size: 0.9rem; }

        .hero { min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 100px 5%; position: relative; }
        .hero-content { text-align: center; z-index: 2; }
        .hero-content h1 { font-size: 3.5rem; margin-bottom: 20px; color: #fff; }
        .hero-content span { color: var(--primary); }

        .main-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px; padding: 50px 5%;
        }

        .card {
            background: var(--card-bg); border: 1px solid rgba(255,255,255,0.05);
            padding: 30px; border-radius: 24px; text-align: center;
            transition: 0.4s; cursor: pointer; position: relative; overflow: hidden;
            text-decoration: none; color: inherit; display: block;
        }

        .card:hover { transform: translateY(-10px); border-color: var(--primary); background: rgba(0, 229, 255, 0.05); }
        .card i { font-size: 2.5rem; color: var(--primary); margin-bottom: 20px; }

        /* Ø´Ø§Ø´Ø© Ø§Ù„Ø­Ø¸Ø± */
        #ban-screen {
            position: fixed; inset: 0; background: #000; z-index: 10000;
            display: none; align-items: center; justify-content: center; text-align: center; flex-direction: column;
        }

        @media (max-width: 768px) {
            .hero-content h1 { font-size: 2.2rem; }
            nav { padding: 10px 5%; }
            .stat-item { font-size: 0.7rem; padding: 5px 10px; }
        }
    </style>
</head>
<body data-theme="dark">

    <div id="emergency-bar" class="animate__animated"></div>
    <div id="particles-js"></div>

    <div id="ban-screen">
        <i class="fas fa-user-slash" style="font-size: 5rem; color: var(--accent); margin-bottom: 20px;"></i>
        <h1 style="color: white;">Ø¹Ø°Ø±Ø§Ù‹ØŒ Ù„Ù‚Ø¯ ØªÙ… Ø­Ø¸Ø±Ùƒ!</h1>
        <p id="ban-reason" style="color: #94a3b8; margin-top: 10px;"></p>
        <p style="margin-top: 20px;">ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ù…Ø³ØªØ± Ù„ÙÙƒ Ø§Ù„Ø­Ø¸Ø±.</p>
    </div>

    <nav>
        <div class="logo animate__animated animate__fadeInLeft">ğŸ§¬ MR HAMDY</div>
        <div class="user-stats">
            <div class="stat-item"><i class="fas fa-wallet"></i> <span id="user-balance">0</span> Ø¬.Ù…</div>
            <div class="stat-item"><i class="fas fa-users"></i> <span id="real-count">0</span></div>
            <button id="theme-toggle" class="stat-item" style="cursor: pointer; background: none;"><i class="fas fa-moon"></i></button>
        </div>
    </nav>

    <section class="hero">
        <div class="hero-content">
            <h1 class="animate__animated animate__zoomIn">Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ± <span>Ø§Ù„Ø£Ø­ÙŠØ§Ø¡</span></h1>
            <p class="animate__animated animate__fadeInUp" style="font-size: 1.2rem; margin-bottom: 30px; opacity: 0.8;">Ù…Ø¹ Ø§Ù„Ù…Ø³ØªØ± Ø­Ù…Ø¯ÙŠ.. Ø§Ù„Ø£Ø­ÙŠØ§Ø¡ ÙÙŠ Ø¬ÙŠØ¨Ùƒ</p>
            <div style="display: flex; gap: 15px; justify-content: center;">
                <a href="videos.html" class="stat-item" style="padding: 12px 30px; text-decoration: none; background: var(--primary); color: #000; font-weight: bold;">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¢Ù†</a>
            </div>
        </div>
    </section>

    <div class="main-grid">
        <a href="videos.html" class="card animate__animated animate__fadeInUp">
            <i class="fas fa-play-circle"></i>
            <h3>Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª</h3>
            <p>Ø´Ø§Ù‡Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù…Ø³Ø¬Ù„Ø© Ø¨Ø¬ÙˆØ¯Ø© Ø¹Ø§Ù„ÙŠØ©</p>
        </a>
        <a href="exams.html" class="card animate__animated animate__fadeInUp" style="animation-delay: 0.1s;">
            <i class="fas fa-file-signature"></i>
            <h3>Ø§Ù„Ø§Ù…ØªØ­Ø§Ù†Ø§Øª</h3>
            <p>Ø§Ø®ØªØ¨Ø± Ù…Ø³ØªÙˆØ§Ùƒ Ù…Ø¹ Ø§Ù…ØªØ­Ø§Ù†Ø§Øª Ø¯ÙˆØ±ÙŠØ©</p>
        </a>
        <a href="contact.html" class="card animate__animated animate__fadeInUp" style="animation-delay: 0.2s;">
            <i class="fas fa-comments"></i>
            <h3>ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</h3>
            <p>Ø§Ø³Ø£Ù„ Ø§Ù„Ù…Ø³ØªØ± Ù…Ø¨Ø§Ø´Ø±Ø© ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª</p>
        </a>
    </div>

    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCcFRLMsewcgYXYgVvdkyQHf-imoJHHzng",
            authDomain: "mrhamdy-1c406.firebaseapp.com",
            databaseURL: "https://mrhamdy-1c406-default-rtdb.firebaseio.com",
            projectId: "mrhamdy-1c406",
            storageBucket: "mrhamdy-1c406.firebasestorage.app",
            messagingSenderId: "806268398144",
            appId: "1:806268398144:web:c40aef6b378377f72b4da5"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø­Ù„ÙŠ
        const userPhone = localStorage.getItem('userLoggedIn');
        const userName = localStorage.getItem('userName') || 'Ø²Ø§Ø¦Ø±';

        // 1. Ù†Ø¸Ø§Ù… Ø§Ù„Ø­Ø¸Ø± ÙˆØ§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù„Ø­Ø¸ÙŠ
        if (userPhone) {
            db.ref('students/' + userPhone).on('value', (snapshot) => {
                const userData = snapshot.val();
                if (userData) {
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ù„Ø­Ø¸ÙŠØ§Ù‹
                    document.getElementById('user-balance').innerText = userData.wallet || 0;

                    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø­Ø¸Ø±
                    if (userData.status === 'banned') {
                        document.getElementById('ban-screen').style.display = 'flex';
                        document.getElementById('ban-reason').innerText = "Ø§Ù„Ø³Ø¨Ø¨: " + (userData.banReason || "ØºÙŠØ± Ù…Ø­Ø¯Ø¯");
                        document.body.style.overflow = 'hidden';
                    } else {
                        document.getElementById('ban-screen').style.display = 'none';
                        document.body.style.overflow = 'auto';
                    }
                }
            });
        } else {
            // Ø¥Ø°Ø§ Ù„Ù… ÙŠØ³Ø¬Ù„ Ø¯Ø®ÙˆÙ„ØŒ ÙŠÙˆØ¬Ù‡ Ù„ØµÙØ­Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„
            window.location.href = "go.html";
        }

        // 2. Ø§Ø³ØªÙ‚Ø¨Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø¹Ø§Ø¬Ù„Ø©
        db.ref('admin/emergency_alert').on('value', (snapshot) => {
            const bar = document.getElementById('emergency-bar');
            if (snapshot.exists()) {
                const data = snapshot.val();
                bar.innerText = "ğŸ“£ " + data.text;
                bar.style.display = 'block';
                bar.classList.add('animate__fadeInDown');
            } else {
                bar.style.display = 'none';
            }
        });

        // 3. Ø¥Ø±Ø³Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† (Ø£Ø³Ù…Ø§Ø¦Ù‡Ù… ÙˆØ£Ø±Ù‚Ø§Ù…Ù‡Ù…)
        const onlineRef = db.ref('admin/online_users/' + userPhone);
        if (userPhone) {
            onlineRef.set({
                name: userName,
                phone: userPhone,
                lastActive: Date.now()
            });
            onlineRef.onDisconnect().remove();
        }

        // 4. Ø¹Ø±Ø¶ Ø¹Ø¯Ø¯ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† Ø§Ù„ÙƒÙ„ÙŠ
        db.ref('admin/online_users').on('value', (snapshot) => {
            document.getElementById('real-count').innerText = snapshot.numChildren() || 0;
        });

        // 5. Ø§Ù„ØªØ¨Ø¯ÙŠÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø«ÙŠÙ…Ø§Øª
        document.getElementById('theme-toggle').onclick = () => {
            const body = document.body;
            const icon = document.querySelector('#theme-toggle i');
            if (body.getAttribute('data-theme') === 'dark') {
                body.setAttribute('data-theme', 'light');
                body.style.backgroundColor = '#f8fafc';
                body.style.color = '#1e293b';
                icon.className = 'fas fa-sun';
            } else {
                body.setAttribute('data-theme', 'dark');
                body.style.backgroundColor = 'var(--bg)';
                body.style.color = 'var(--text)';
                icon.className = 'fas fa-moon';
            }
        };

        // 6. Ø¬Ø²ÙŠØ¦Ø§Øª Ø§Ù„Ø®Ù„ÙÙŠØ©
        particlesJS('particles-js', {
            particles: {
                number: { value: 60 },
                color: { value: '#00e5ff' },
                shape: { type: 'circle' },
                opacity: { value: 0.3 },
                size: { value: 2 },
                line_linked: { enable: true, distance: 150, color: '#00e5ff', opacity: 0.2, width: 1 },
                move: { enable: true, speed: 2 }
            }
        });
    </script>
</body>
</html>
