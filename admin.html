<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ù…Ø³ØªØ± Ø­Ù…Ø¯ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary: #00bfa5; --accent: #ff1744; --bg: #0b111e; --card: #1e293b; --text: #ffffff; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }
        body { background-color: var(--bg); color: var(--text); padding: 20px; }
        
        #login-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 2000; display: flex; align-items: center; justify-content: center; }
        .login-card { background: var(--card); padding: 40px; border-radius: 20px; border: 1px solid var(--primary); text-align: center; width: 90%; max-width: 400px; }
        
        header { display: flex; justify-content: space-between; align-items: center; background: var(--card); padding: 20px; border-radius: 15px; margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.05); }
        
        .admin-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; }
        .box { background: var(--card); padding: 25px; border-radius: 20px; border: 1px solid rgba(255,255,255,0.05); }
        
        .msg-item { background: #0f172a; padding: 15px; border-radius: 12px; margin-bottom: 15px; border-right: 4px solid var(--accent); }
        
        input, textarea { width: 100%; padding: 12px; margin-top: 10px; border-radius: 8px; border: 1px solid #334155; background: #0b111e; color: white; outline: none; font-size: 0.9rem; }
        input:focus, textarea:focus { border-color: var(--primary); }
        
        .btn { width: 100%; padding: 12px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; margin-top: 10px; transition: 0.3s; display: flex; align-items: center; justify-content: center; gap: 8px; }
        .btn-p { background: var(--primary); color: white; }
        .btn-a { background: var(--accent); color: white; }
        .btn:hover { opacity: 0.8; transform: translateY(-2px); }
        
        .btn-delete-all { background: transparent; color: #94a3b8; border: 1px solid #334155; font-size: 0.8rem; margin-top: 20px; }
        .btn-delete-all:hover { background: #ef4444; color: white; border-color: #ef4444; }

        h2 { font-size: 1.2rem; margin-bottom: 15px; color: var(--primary); display: flex; align-items: center; gap: 10px; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-card">
            <i class="fas fa-user-shield" style="font-size: 3rem; color: var(--primary); margin-bottom: 15px;"></i>
            <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±</h2>
            <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø§Ù„Ø®Ø§ØµØ© Ø¨Ùƒ">
            <button class="btn btn-p" onclick="login()">Ø¯Ø®ÙˆÙ„ Ù„Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</button>
        </div>
    </div>

    <main id="admin-content" style="display:none;">
        <header>
            <h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ğŸ§¬ <small style="font-size: 0.9rem; opacity: 0.6;">Ù…Ø³ØªØ± Ø­Ù…Ø¯ÙŠ</small></h1>
            <div style="background: rgba(0, 191, 165, 0.1); padding: 8px 15px; border-radius: 10px; border: 1px solid var(--primary);">
                <i class="fas fa-users" style="color: var(--primary);"></i> Ø§Ù„Ù…ØªØµÙ„ÙŠÙ† Ø§Ù„Ø¢Ù†: <span id="online-count" style="font-weight: 900;">0</span>
            </div>
        </header>

        <div class="admin-grid">
            <div class="box">
                <h2><i class="fas fa-envelope"></i> Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨</h2>
                <div id="msg-display" style="max-height: 500px; overflow-y: auto; padding-right: 5px;">
                    <p style="text-align: center; opacity: 0.5;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø±Ø³Ø§Ø¦Ù„ Ø­Ø§Ù„ÙŠØ§Ù‹...</p>
                </div>
            </div>

            <div class="box">
                <h2><i class="fas fa-bullhorn"></i> Ù†Ø¸Ø§Ù… Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª (Ø¨Ø« Ù…Ø¨Ø§Ø´Ø±)</h2>
                <p style="font-size: 0.8rem; opacity: 0.6; margin-bottom: 10px;">Ø³ÙŠØ¸Ù‡Ø± Ù‡Ø°Ø§ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø­ØªÙ‰ Ù„Ùˆ ÙØªØ­ÙˆØ§ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù„Ø§Ø­Ù‚Ø§Ù‹.</p>
                <textarea id="notif-input" rows="3" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ù‡Ù†Ø§..."></textarea>
                <button class="btn btn-a" onclick="sendNotif()">
                    <i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ù„Ù„Ø¬Ù…ÙŠØ¹
                </button>
                
                <button class="btn btn-delete-all" onclick="clearNotifs()">
                    <i class="fas fa-trash-alt"></i> Ù…Ø³Ø­ Ø³Ø¬Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
                </button>

                <hr style="margin:30px 0; border: 0; border-top: 1px solid rgba(255,255,255,0.1);">
                
                <h2><i class="fas fa-image"></i> ØªØºÙŠÙŠØ± Ø¨ÙˆØ³ØªØ± Ø§Ù„ØµÙØ­Ø©</h2>
                <input type="text" id="p-url" placeholder="Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø± Ù‡Ù†Ø§">
                <button class="btn btn-p" onclick="updatePoster()">
                    <i class="fas fa-sync-alt"></i> ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø© ÙÙˆØ±Ø§Ù‹
                </button>
            </div>
        </div>
    </main>

    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCcFRLMsewcgYXYgVvdkyQHf-imoJHHzng",
            authDomain: "mrhamdy-1c406.firebaseapp.com",
            databaseURL: "https://mrhamdy-1c406-default-rtdb.firebaseio.com",
            projectId: "mrhamdy-1c406",
            storageBucket: "mrhamdy-1c406.firebasestorage.app",
            messagingSenderId: "806268398144",
            appId: "1:806268398144:web:e7c9b87205cbb6fb2b4da5"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function login() {
            if(document.getElementById('pass').value === 'hamdyhamdy012345') {
                document.getElementById('login-overlay').style.display='none';
                document.getElementById('admin-content').style.display='block';
                loadAdmin();
            } else {
                alert("ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø± Ø®Ø§Ø·Ø¦Ø© ÙŠØ§ Ù…Ø³ØªØ±!");
            }
        }

        function loadAdmin() {
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†
            db.ref('admin/online_users').on('value', s => {
                document.getElementById('online-count').innerText = s.numChildren() || 0;
            });
            
            // Ø¬Ù„Ø¨ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„
            db.ref('admin/messages').on('value', s => {
                const display = document.getElementById('msg-display');
                display.innerHTML = "";
                const data = s.val();
                if(data) {
                    Object.keys(data).reverse().forEach(key => {
                        const m = data[key];
                        display.innerHTML += `
                            <div class="msg-item">
                                <strong>${m.sender}</strong> <small style="float:left; opacity:0.5">${m.time}</small>
                                <p style="margin:10px 0; color: #cbd5e1;">${m.message}</p>
                                <input type="text" id="rep-${key}" placeholder="Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ù„Ø¨...">
                                <button class="btn btn-p" style="padding: 5px; font-size: 0.8rem;" onclick="reply('${key}')">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯</button>
                                <button onclick="del('${key}')" style="background:none; border:none; color:var(--accent); cursor:pointer; margin-top:10px; font-size:0.8rem; display:block;">Ø­Ø°Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø© <i class="fas fa-trash"></i></button>
                            </div>`;
                    });
                } else {
                    display.innerHTML = '<p style="text-align: center; opacity: 0.5;">ØµÙ†Ø¯ÙˆÙ‚ Ø§Ù„ÙˆØ§Ø±Ø¯ ÙØ§Ø±Øº</p>';
                }
            });
        }

        function reply(id) {
            const txt = document.getElementById('rep-'+id).value;
            if(txt) {
                db.ref('admin/replies/'+id).set({ 
                    text: txt, 
                    time: new Date().toLocaleString('ar-EG') 
                }).then(() => {
                    alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯ Ù„Ù„Ø·Ø§Ù„Ø¨");
                    document.getElementById('rep-'+id).value = "";
                });
            }
        }

        function del(id) {
            if(confirm("Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹ØŸ")) {
                db.ref('admin/messages/'+id).remove();
                db.ref('admin/replies/'+id).remove();
            }
        }

        // Ø¥Ø±Ø³Ø§Ù„ ØªÙ†Ø¨ÙŠÙ‡ (Ù†Ø¸Ø§Ù… Push Ø§Ù„Ø¬Ø¯ÙŠØ¯)
        function sendNotif() {
            const t = document.getElementById('notif-input').value;
            if(t) {
                // Ù†Ø³ØªØ®Ø¯Ù… notifications Ø¨Ø§Ù„Ø¬Ù…Ø¹ Ù„ØªØªÙˆØ§ÙÙ‚ Ù…Ø¹ ÙƒÙˆØ¯ Ø§Ù„Ø·Ø§Ù„Ø¨ Ø§Ù„Ù…Ø·ÙˆØ±
                db.ref('admin/notifications').push({ 
                    text: t, 
                    time: Date.now() 
                }).then(() => {
                    alert("ØªÙ… Ø¨Ø« Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨!");
                    document.getElementById('notif-input').value = "";
                });
            } else {
                alert("Ø§ÙƒØªØ¨ Ø§Ù„Ù†Øµ Ø£ÙˆÙ„Ø§Ù‹!");
            }
        }

        // Ù…Ø³Ø­ ÙƒØ§ÙØ© Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª
        function clearNotifs() {
            if(confirm("Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø³Ø¬Ù„ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù…Ù† Ø¹Ù†Ø¯ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø§Ø¨ØŒ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ØŸ")) {
                db.ref('admin/notifications').remove().then(() => alert("ØªÙ… ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø³Ø¬Ù„"));
            }
        }

        function updatePoster() {
            const u = document.getElementById('p-url').value;
            if(u) {
                db.ref('admin/poster_url').set(u).then(() => {
                    alert("ØªÙ… ØªØ­Ø¯ÙŠØ« ØµÙˆØ±Ø© Ø§Ù„Ù…Ø³ØªØ± ÙÙŠ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©");
                    document.getElementById('p-url').value = "";
                });
            }
        }
    </script>
</body>
</html>
