<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | Ù…Ø³ØªØ± Ø­Ù…Ø¯ÙŠ</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --primary: #00bfa5; --accent: #ff1744; --bg: #0b111e; --card: #1e293b; --text: #ffffff; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Cairo', sans-serif; }
        body { background-color: var(--bg); color: var(--text); padding: 20px; }
        #login-overlay { position: fixed; inset: 0; background: var(--bg); z-index: 2000; display: flex; align-items: center; justify-content: center; }
        .login-card { background: var(--card); padding: 40px; border-radius: 20px; border: 1px solid var(--primary); text-align: center; }
        header { display: flex; justify-content: space-between; align-items: center; background: var(--card); padding: 20px; border-radius: 15px; margin-bottom: 30px; }
        .admin-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 25px; }
        .box { background: var(--card); padding: 25px; border-radius: 20px; }
        .msg-item { background: #0f172a; padding: 15px; border-radius: 12px; margin-bottom: 15px; border-right: 4px solid var(--accent); }
        input, textarea { width: 100%; padding: 10px; margin-top: 10px; border-radius: 8px; border: 1px solid #334155; background: #0b111e; color: white; outline: none; }
        .btn { width: 100%; padding: 10px; border-radius: 8px; border: none; cursor: pointer; font-weight: bold; margin-top: 10px; }
        .btn-p { background: var(--primary); color: white; }
        .btn-a { background: var(--accent); color: white; }
    </style>
</head>
<body>
    <div id="login-overlay">
        <div class="login-card">
            <h2>Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø¥Ù…Ø¨Ø±Ø§Ø·ÙˆØ±</h2>
            <input type="password" id="pass" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ø³Ø±">
            <button class="btn btn-p" onclick="login()">Ø¯Ø®ÙˆÙ„</button>
        </div>
    </div>

    <main id="admin-content" style="display:none;">
        <header>
            <h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ğŸ§¬</h1>
            <div>Ø§Ù„Ù…ØªØµÙ„ÙŠÙ†: <span id="online-count">0</span></div>
        </header>

        <div class="admin-grid">
            <div class="box">
                <h2><i class="fas fa-envelope"></i> Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ø·Ù„Ø§Ø¨ ÙˆØ§Ù„Ø±Ø¯ Ø¹Ù„ÙŠÙ‡Ø§</h2>
                <div id="msg-display" style="max-height: 500px; overflow-y: auto; margin-top: 15px;"></div>
            </div>

            <div class="box">
                <h2><i class="fas fa-bullhorn"></i> Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡Ø§Øª ÙˆØ§Ù„Ø¨ÙˆØ³ØªØ±</h2>
                <textarea id="notif-input" placeholder="Ø§ÙƒØªØ¨ ØªÙ†Ø¨ÙŠÙ‡ Ø¹Ø§Ù…..."></textarea>
                <button class="btn btn-a" onclick="sendNotif()">Ø¨Ø« ØªÙ†Ø¨ÙŠÙ‡</button>
                <hr style="margin:20px 0; opacity:0.1;">
                <input type="text" id="p-url" placeholder="Ø±Ø§Ø¨Ø· Ø§Ù„Ø¨ÙˆØ³ØªØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯">
                <button class="btn btn-p" onclick="updatePoster()">ØªØ­Ø¯ÙŠØ« Ø§Ù„ØµÙˆØ±Ø©</button>
            </div>
        </div>
    </main>

    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-database-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCcFRLMsewcgYXYgVvdkyQHf-imoJHHzng",
            authDomain: "mrhamdy-1c406.firebaseapp.com",
            databaseURL: "https://mrhamdy-1c406-default-rtdb.firebaseio.com",
            projectId: "mrhamdy-1c406",
            storageBucket: "mrhamdy-1c406.firebasestorage.app",
            messagingSenderId: "806268398144",
            appId: "1:806268398144:web:e7c9b87205cbb6fb2b4da5"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function login() {
            if(document.getElementById('pass').value === 'hamdyhamdy012345') {
                document.getElementById('login-overlay').style.display='none';
                document.getElementById('admin-content').style.display='block';
                loadAdmin();
            } else alert("Ø®Ø·Ø£!");
        }

        function loadAdmin() {
            db.ref('admin/online_users').on('value', s => document.getElementById('online-count').innerText = s.numChildren() || 0);
            
            db.ref('admin/messages').on('value', s => {
                const display = document.getElementById('msg-display');
                display.innerHTML = "";
                const data = s.val();
                if(data) {
                    Object.keys(data).reverse().forEach(key => {
                        const m = data[key];
                        display.innerHTML += `
                            <div class="msg-item">
                                <strong>${m.sender}</strong> <small style="opacity:0.5">${m.time}</small>
                                <p style="margin:10px 0;">${m.message}</p>
                                <input type="text" id="rep-${key}" placeholder="Ø§ÙƒØªØ¨ Ø±Ø¯Ùƒ Ù‡Ù†Ø§...">
                                <button class="btn btn-p" onclick="reply('${key}')">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø¯</button>
                                <button onclick="del('${key}')" style="background:none; border:none; color:var(--accent); cursor:pointer; margin-top:10px; font-size:0.8rem;">Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©</button>
                            </div>`;
                    });
                }
            });
        }

        function reply(id) {
            const txt = document.getElementById('rep-'+id).value;
            if(txt) {
                db.ref('admin/replies/'+id).set({ text: txt, time: new Date().toLocaleString('ar-EG') })
                .then(() => alert("ØªÙ… Ø§Ù„Ø±Ø¯!"));
            }
        }

        function del(id) {
            if(confirm("Ø­Ø°ÙØŸ")) {
                db.ref('admin/messages/'+id).remove();
                db.ref('admin/replies/'+id).remove();
            }
        }

        function sendNotif() {
            const t = document.getElementById('notif-input').value;
            if(t) db.ref('admin/notification').set({ text: t, time: Date.now() }).then(()=>alert("ØªÙ…!"));
        }

        function updatePoster() {
            const u = document.getElementById('p-url').value;
            if(u) db.ref('admin/poster_url').set(u).then(()=>alert("ØªÙ…!"));
        }
    </script>
</body>
</html>
